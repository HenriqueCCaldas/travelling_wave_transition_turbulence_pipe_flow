(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     32021,        866]
NotebookOptionsPosition[     30225,        827]
NotebookOutlinePosition[     30618,        843]
CellTagsIndexPosition[     30575,        840]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fast Slow Analysis ", "Title",
 CellChangeTimes->{{3.945750679460683*^9, 3.9457507009770603`*^9}, {
  3.945751146979055*^9, 
  3.945751151625277*^9}},ExpressionUUID->"8db55d0f-f02a-4d9d-865a-\
c120f3704bec"],

Cell[" ODE system ", "Subtitle",
 CellChangeTimes->{
  3.945750767748633*^9, {3.945751153115616*^9, 
   3.945751161030037*^9}},ExpressionUUID->"c8153deb-aeb0-4c36-a643-\
e6822f47929e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Finding", " ", "the", " ", "equilibria", " ", "system"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\[Phi]", ",", "\[Psi]", ",", "A", ",", "B", ",", "M", ",", "InvM", ",", 
      "RHS", ",", "DynSis", ",", "phiPrime", ",", "psiPrime", ",", "APrime", 
      ",", "BPrime", ",", "Da", ",", "Db", ",", "dA", ",", "dB", ",", "p", 
      ",", "b", ",", "m", ",", "s", ",", " ", "A1", ",", " ", "A2", ",", " ", 
      "B1", ",", " ", "B2", ",", " ", "NumA1", ",", " ", "NumA2", ",", " ", 
      "NumB1", ",", " ", "NumB2", ",", " ", "NumEigAtEq1", ",", " ", 
      "NumEigAtEq2", ",", " ", "EigAtEq1", ",", " ", "EigAtEq2"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "dA"}], "*", "A"}], "+", 
     RowBox[{"m", "*", "B"}], "+", 
     RowBox[{"2", "*", "p", "*", "A", "*", "B"}]}]}], "\n", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"B", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "dB"}], "-", "m", "-", 
       RowBox[{"2", "*", "p", "*", "A"}], "+", 
       RowBox[{"2", "*", "b"}], "-", 
       RowBox[{"2", "*", "b", "*", 
        RowBox[{"(", 
         RowBox[{"A", "+", "B"}], ")"}]}]}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Da", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "B"}], ")"}]}], "+", 
          RowBox[{"p", "*", "B"}]}], ",", 
         RowBox[{"Da", "*", "A"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Db", "*", "B"}], ",", 
         RowBox[{
          RowBox[{"Db", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "A"}], ")"}]}], "-", 
          RowBox[{"b", "*", 
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}]}]}], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Vector", " ", "on", " ", "the", " ", "right"}], "-", 
     RowBox[{"hand", " ", "side"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"RHS", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "s"}], "*", "\[Phi]"}], "-", 
        RowBox[{"F", "[", 
         RowBox[{"A", ",", "B"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "s"}], "*", "\[Psi]"}], "-", 
        RowBox[{"G", "[", 
         RowBox[{"A", ",", "B"}], "]"}]}], ",", "\[Phi]", ",", "\[Psi]"}], 
      "}"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"order", " ", "replacer"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"dA", " ", "=", " ", "\[Epsilon]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dB", " ", "=", " ", "\[Epsilon]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"m", " ", "=", " ", 
     RowBox[{"\[Epsilon]", "^", "2"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Inverted", " ", "left"}], "-", 
     RowBox[{"hand", " ", "side", " ", "matrix"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"InvM", "=", " ", 
     RowBox[{"Inverse", "[", "M", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Isolating", " ", "derivatives", " ", "on", " ", "the", " ", "right", 
      " ", "hand"}], "-", 
     RowBox[{"side", " ", 
      RowBox[{"{", 
       RowBox[{"phiPrime", ",", "psiPrime", ",", "APrime", ",", "BPrime"}], 
       "}"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"DynSis", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"InvM", ".", "RHS"}], "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.945750828332218*^9, 3.945750853180151*^9}, {
   3.945750897238057*^9, 3.9457509481169853`*^9}, 3.945751168210994*^9, {
   3.9457537604238663`*^9, 3.945753795360165*^9}, {3.945770711402652*^9, 
   3.945770714899729*^9}, {3.945770755334628*^9, 3.945770893491384*^9}, {
   3.94577095157812*^9, 3.9457709612018337`*^9}, {3.945771002434411*^9, 
   3.945771214492611*^9}, {3.945773065216639*^9, 3.9457731104932404`*^9}, {
   3.945773455798366*^9, 3.9457734601775637`*^9}, {3.945773555158053*^9, 
   3.9457736076370897`*^9}, {3.945773638857942*^9, 3.9457737369626226`*^9}, {
   3.945773774369027*^9, 3.9457739039759502`*^9}, {3.945773939692342*^9, 
   3.9457739670059433`*^9}, 3.9457746998773003`*^9, {3.945774730418648*^9, 
   3.9457748019692707`*^9}, {3.94577484148209*^9, 3.945774844005422*^9}, {
   3.945775387447763*^9, 3.945775406468506*^9}, {3.945775628748666*^9, 
   3.945775639162632*^9}, {3.945911846337823*^9, 3.945911848274906*^9}, {
   3.945911894768074*^9, 3.945911895767487*^9}, {3.946021936724917*^9, 
   3.9460219562278852`*^9}, {3.946021986504294*^9, 3.9460219956823597`*^9}, {
   3.946022174933938*^9, 3.946022243815835*^9}},
 CellLabel->
  "In[1081]:=",ExpressionUUID->"543cf84c-511d-44fe-a6af-5b20649ca83d"],

Cell[CellGroupData[{

Cell["Left-hand inverse matrix M", "Subsubsection",
 CellChangeTimes->{{3.945911860494439*^9, 
  3.9459118805877934`*^9}},ExpressionUUID->"1e5821ba-c57c-4441-9bff-\
ec7698be8f07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"InvM", ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], " ", "//", 
  "MatrixForm"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "now", " ", "makes", " ", "sense"}], ",", " ", 
    RowBox[{
    "as", " ", "we", " ", "dont", " ", "have", " ", "any", " ", "of", " ", 
     "the", " ", "epsilon", " ", "parameters", " ", "on", " ", "this", " ", 
     "side", " ", "of", " ", "the", " ", "system"}]}], "*)"}]}]}], "Code",
 CellChangeTimes->{{3.945911884946447*^9, 3.945911931724966*^9}, {
  3.945911981403941*^9, 3.945911981573517*^9}, {3.946022220204172*^9, 
  3.946022220570887*^9}, {3.946022421258758*^9, 
  3.946022450742188*^9}},ExpressionUUID->"c33c27fd-c3ae-489c-a5a1-\
7f9ed186d9f1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "A"}], " ", "b"}], "-", 
        RowBox[{"b", " ", "B"}], "+", "Db", "-", 
        RowBox[{"A", " ", "Db"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b"}], " ", 
            RowBox[{"(", 
             RowBox[{"A", "+", "B"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "A"}], ")"}], " ", "Db"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "B"}], ")"}], " ", "Da"}], "+", 
           RowBox[{"B", " ", "p"}]}], ")"}]}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"A", " ", "Da"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], " ", 
             RowBox[{"(", 
              RowBox[{"A", "+", "B"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "A"}], ")"}], " ", "Db"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "B"}], ")"}], " ", "Da"}], "+", 
            RowBox[{"B", " ", "p"}]}], ")"}]}]}]]}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"B", " ", "Db"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "b"}], " ", 
             RowBox[{"(", 
              RowBox[{"A", "+", "B"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "A"}], ")"}], " ", "Db"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "B"}], ")"}], " ", "Da"}], "+", 
            RowBox[{"B", " ", "p"}]}], ")"}]}]}]]}], 
      FractionBox[
       RowBox[{"Da", "-", 
        RowBox[{"B", " ", "Da"}], "+", 
        RowBox[{"B", " ", "p"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "b"}], " ", 
            RowBox[{"(", 
             RowBox[{"A", "+", "B"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "A"}], ")"}], " ", "Db"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "B"}], ")"}], " ", "Da"}], "+", 
           RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.94591190274649*^9, 3.945911932255084*^9}, {
   3.94591197077127*^9, 3.94591198184168*^9}, 3.946022007482785*^9, {
   3.946022213579417*^9, 3.946022250296052*^9}},
 CellLabel->
  "Out[1091]//MatrixForm=",ExpressionUUID->"7b46f2fc-ad4e-4dae-9a65-\
308e4b78d850"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Whole ODE System ",
 Cell[BoxData[
  FormBox["Expansion", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ea6e0f60-056e-4c62-8a28-62ef8f3ab367"]
}], "Subsubsection",
 CellChangeTimes->{{3.945912002857347*^9, 3.945912017968107*^9}, {
  3.9460217189858294`*^9, 3.946021723836486*^9}, {3.946022253787574*^9, 
  3.946022270917945*^9}},ExpressionUUID->"70788c03-30f0-45b5-add6-\
4f50fa716f58"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"DynSis", ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], " ", "//", 
  "MatrixForm"}]], "Code",
 CellChangeTimes->{{3.945775615903524*^9, 3.9457756450488453`*^9}, {
  3.945911978734923*^9, 3.945911979125431*^9}},
 CellLabel->
  "In[1092]:=",ExpressionUUID->"449c6e4c-3b47-4f1b-8f51-b438b8d93835"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       InterpretationBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"A", " ", "B", " ", "Da", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "b", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A", "+", "B"}], ")"}]}], "-", 
              RowBox[{"2", " ", "A", " ", "p"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "A", " ", "B", " ", "p"}], "+", 
              RowBox[{"s", " ", "\[Phi]"}]}], ")"}]}], "+", 
           RowBox[{"A", " ", "Da", " ", "s", " ", "\[Psi]"}]}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
              RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "A"}], " ", "B", " ", "Da"}], "-", 
             RowBox[{"A", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", " ", 
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], 
               ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
              RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "A"}], " ", "B", " ", "Da"}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"b", " ", 
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], 
               ")"}]}]}], ")"}], " ", 
           SuperscriptBox["\[Epsilon]", "2"]}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
              RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "+", 
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
          SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
          Editable->False]}],
        SeriesData[$CellContext`\[Epsilon], 
         0, {(-$CellContext`A $CellContext`B $CellContext`Da $CellContext`Db + \
($CellContext`b ($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) \
$CellContext`Db) ((-1 + $CellContext`B) $CellContext`Da - $CellContext`B \
$CellContext`p))^(-1) ($CellContext`A $CellContext`B $CellContext`Da ((-2) \
$CellContext`b (-1 + $CellContext`A + $CellContext`B) - 
             2 $CellContext`A $CellContext`p) + ($CellContext`b \
($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) $CellContext`Db) (
             2 $CellContext`A $CellContext`B $CellContext`p + $CellContext`s \
$CellContext`\[Phi]) + $CellContext`A $CellContext`Da $CellContext`s \
$CellContext`\[Psi]), (-$CellContext`A $CellContext`B $CellContext`Da - \
$CellContext`A ($CellContext`b ($CellContext`A + $CellContext`B) + (-1 + \
$CellContext`A) $CellContext`Db))/(-$CellContext`A $CellContext`B \
$CellContext`Da $CellContext`Db + ($CellContext`b ($CellContext`A + \
$CellContext`B) + (-1 + $CellContext`A) $CellContext`Db) ((-1 + \
$CellContext`B) $CellContext`Da - $CellContext`B $CellContext`p)), \
(-$CellContext`A $CellContext`B $CellContext`Da + $CellContext`B \
($CellContext`b ($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) \
$CellContext`Db))/(-$CellContext`A $CellContext`B $CellContext`Da \
$CellContext`Db + ($CellContext`b ($CellContext`A + $CellContext`B) + (-1 + \
$CellContext`A) $CellContext`Db) ((-1 + $CellContext`B) $CellContext`Da - \
$CellContext`B $CellContext`p))}, 0, 3, 1],
        Editable->False]},
      {
       InterpretationBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"B", " ", "Db", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "A", " ", "B", " ", "p"}], "+", 
              RowBox[{"s", " ", "\[Phi]"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Da", "-", 
              RowBox[{"B", " ", "Da"}], "+", 
              RowBox[{"B", " ", "p"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"B", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "b", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "A", "+", "B"}], ")"}]}], "+", 
                 RowBox[{"2", " ", "A", " ", "p"}]}], ")"}]}], "-", 
              RowBox[{"s", " ", "\[Psi]"}]}], ")"}]}]}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
              RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "A"}], " ", "B", " ", "Db"}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"(", 
               RowBox[{"Da", "-", 
                RowBox[{"B", " ", "Da"}], "+", 
                RowBox[{"B", " ", "p"}]}], ")"}]}]}], ")"}], " ", 
           "\[Epsilon]"}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
              RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["B", "2"], " ", "Db"}], "+", 
             RowBox[{"B", " ", 
              RowBox[{"(", 
               RowBox[{"Da", "-", 
                RowBox[{"B", " ", "Da"}], "+", 
                RowBox[{"B", " ", "p"}]}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["\[Epsilon]", "2"]}], 
          RowBox[{
           RowBox[{
            RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}]}], ")"}], 
            " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
              RowBox[{"B", " ", "p"}]}], ")"}]}]}]], "+", 
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
          SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
          Editable->False]}],
        SeriesData[$CellContext`\[Epsilon], 
         0, {(-$CellContext`A $CellContext`B $CellContext`Da $CellContext`Db + \
($CellContext`b ($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) \
$CellContext`Db) ((-1 + $CellContext`B) $CellContext`Da - $CellContext`B \
$CellContext`p))^(-1) ($CellContext`B $CellContext`Db (
             2 $CellContext`A $CellContext`B $CellContext`p + $CellContext`s \
$CellContext`\[Phi]) + ($CellContext`Da - $CellContext`B $CellContext`Da + \
$CellContext`B $CellContext`p) ($CellContext`B (
               2 $CellContext`b (-1 + $CellContext`A + $CellContext`B) + 
               2 $CellContext`A $CellContext`p) - $CellContext`s \
$CellContext`\[Psi])), (-$CellContext`A $CellContext`B $CellContext`Da \
$CellContext`Db + ($CellContext`b ($CellContext`A + $CellContext`B) + (-1 + \
$CellContext`A) $CellContext`Db) ((-1 + $CellContext`B) $CellContext`Da - \
$CellContext`B $CellContext`p))^(-1) (-$CellContext`A $CellContext`B \
$CellContext`Db + $CellContext`B ($CellContext`Da - $CellContext`B \
$CellContext`Da + $CellContext`B $CellContext`p)), (-$CellContext`A \
$CellContext`B $CellContext`Da $CellContext`Db + ($CellContext`b \
($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) $CellContext`Db) \
((-1 + $CellContext`B) $CellContext`Da - $CellContext`B $CellContext`p))^(-1) \
($CellContext`B^2 $CellContext`Db + $CellContext`B ($CellContext`Da - \
$CellContext`B $CellContext`Da + $CellContext`B $CellContext`p))}, 0, 3, 1],
        Editable->False]},
      {"\[Phi]"},
      {"\[Psi]"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945775616974102*^9, 3.945775645567483*^9}, 
   3.94591197959517*^9, 3.9460220235483503`*^9, 3.946022259653265*^9},
 CellLabel->
  "Out[1092]//MatrixForm=",ExpressionUUID->"db79f8ca-cc19-4e0b-8602-\
ef03204aa69f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"DynSis", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "->", " ", "\[Epsilon]"}], ",", " ", 
      RowBox[{"b", "->", "\[Epsilon]"}]}], "}"}]}], "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.945753216603607*^9, 3.945753221358643*^9}, {
   3.945753257726884*^9, 3.9457532631574793`*^9}, {3.945753503932041*^9, 
   3.9457535814110413`*^9}, {3.9457536182588253`*^9, 
   3.9457536322847557`*^9}, {3.945753689410222*^9, 3.9457536909653378`*^9}, {
   3.945753733994916*^9, 3.945753737772562*^9}, {3.945753809525464*^9, 
   3.945753813276737*^9}, 3.945754303978817*^9, {3.9457739877791348`*^9, 
   3.945774000073498*^9}},
 CellLabel->
  "In[1044]:=",ExpressionUUID->"77d76c94-0302-4faa-80d2-4ea60201c85d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"4", " ", "A"}], "+", 
            RowBox[{"2", " ", "B"}], "+", "\[Epsilon]"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", "+", "B"}], ")"}], " ", "\[Epsilon]"}]}], ")"}], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "B"}]}], ")"}], " ", "\[Epsilon]"}], "+", 
            RowBox[{"B", " ", 
             SuperscriptBox["\[Epsilon]", "2"]}], "+", 
            RowBox[{"s", " ", "\[Phi]"}]}], ")"}]}], "+", 
         RowBox[{"A", " ", "Da", " ", "s", " ", "\[Psi]"}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
            RowBox[{"B", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", "+", "B"}], ")"}], " ", "\[Epsilon]"}]}], 
           ")"}]}]}]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"B", " ", "Db", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "B"}]}], ")"}], " ", "\[Epsilon]"}], "+", 
            RowBox[{"B", " ", 
             SuperscriptBox["\[Epsilon]", "2"]}], "+", 
            RowBox[{"s", " ", "\[Phi]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Da", "-", 
            RowBox[{"B", " ", "Da"}], "+", 
            RowBox[{"B", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"B", " ", "\[Epsilon]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"4", " ", "A"}], "+", 
               RowBox[{"2", " ", "B"}], "+", "\[Epsilon]"}], ")"}]}], "-", 
            RowBox[{"s", " ", "\[Psi]"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "A"}], " ", "B", " ", "Da", " ", "Db"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "Da"}], "-", 
            RowBox[{"B", " ", "\[Epsilon]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "Db"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"A", "+", "B"}], ")"}], " ", "\[Epsilon]"}]}], 
           ")"}]}]}]]},
      {"\[Phi]"},
      {"\[Psi]"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.945753813754382*^9, 3.9457541443831577`*^9, 3.945754305237883*^9, 
   3.945758090871977*^9, 3.9457731148527193`*^9, {3.94577399482552*^9, 
   3.9457740004002447`*^9}, 3.945911964335432*^9, 3.94602203402621*^9},
 CellLabel->
  "Out[1044]//MatrixForm=",ExpressionUUID->"efd37278-277c-4c3c-b6ba-\
7e915d9f5cdf"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"357c353f-00b8-4c9b-b950-fb9bfd3c4170"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9457508251604958`*^9},ExpressionUUID->"5acbc3da-3a78-48e5-8011-\
670b1a02efa8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.945750778910378*^9, 
  3.945750779783099*^9}},ExpressionUUID->"a5da3ba7-2714-4f5e-ba11-\
00c67949d52a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 8}, {Automatic, 8}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1a41f983-6cde-40c9-b982-7ed12c0e284f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 213, 4, 96, "Title",ExpressionUUID->"8db55d0f-f02a-4d9d-865a-c120f3704bec"],
Cell[792, 28, 184, 4, 52, "Subtitle",ExpressionUUID->"c8153deb-aeb0-4c36-a643-e6822f47929e"],
Cell[979, 34, 5145, 130, 315, "Code",ExpressionUUID->"543cf84c-511d-44fe-a6af-5b20649ca83d"],
Cell[CellGroupData[{
Cell[6149, 168, 179, 3, 43, "Subsubsection",ExpressionUUID->"1e5821ba-c57c-4441-9bff-ec7698be8f07"],
Cell[CellGroupData[{
Cell[6353, 175, 818, 19, 69, "Code",ExpressionUUID->"c33c27fd-c3ae-489c-a5a1-7f9ed186d9f1"],
Cell[7174, 196, 3799, 115, 114, "Output",ExpressionUUID->"7b46f2fc-ad4e-4dae-9a65-308e4b78d850"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11022, 317, 427, 10, 43, "Subsubsection",ExpressionUUID->"70788c03-30f0-45b5-add6-4f50fa716f58"],
Cell[CellGroupData[{
Cell[11474, 331, 399, 10, 51, "Code",ExpressionUUID->"449c6e4c-3b47-4f1b-8f51-b438b8d93835"],
Cell[11876, 343, 12674, 318, 122, "Output",ExpressionUUID->"db79f8ca-cc19-4e0b-8602-ef03204aa69f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24587, 666, 806, 16, 51, "Code",ExpressionUUID->"77d76c94-0302-4faa-80d2-4ea60201c85d"],
Cell[25396, 684, 4417, 126, 124, "Output",ExpressionUUID->"efd37278-277c-4c3c-b6ba-7e915d9f5cdf"]
}, Open  ]],
Cell[29828, 813, 81, 0, 29, "Input",ExpressionUUID->"357c353f-00b8-4c9b-b950-fb9bfd3c4170"],
Cell[29912, 815, 130, 3, 29, "Input",ExpressionUUID->"5acbc3da-3a78-48e5-8011-670b1a02efa8"],
Cell[30045, 820, 152, 3, 29, "Input",ExpressionUUID->"a5da3ba7-2714-4f5e-ba11-00c67949d52a"]
}, Open  ]]
}, Open  ]]
}
]
*)

