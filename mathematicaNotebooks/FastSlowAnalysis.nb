(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     37906,        937]
NotebookOptionsPosition[     36600,        908]
NotebookOutlinePosition[     36993,        924]
CellTagsIndexPosition[     36950,        921]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fast Slow Analysis ", "Title",
 CellChangeTimes->{{3.945750679460683*^9, 3.9457507009770603`*^9}, {
  3.945751146979055*^9, 
  3.945751151625277*^9}},ExpressionUUID->"8db55d0f-f02a-4d9d-865a-\
c120f3704bec"],

Cell[" ODE system ", "Subtitle",
 CellChangeTimes->{
  3.945750767748633*^9, {3.945751153115616*^9, 
   3.945751161030037*^9}},ExpressionUUID->"c8153deb-aeb0-4c36-a643-\
e6822f47929e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Finding", " ", "the", " ", "equilibria", " ", "system"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{
     "\[Phi]", ",", "\[Psi]", ",", "A", ",", "B", ",", "M", ",", "InvM", ",", 
      "RHS", ",", "DynSis", ",", "phiPrime", ",", "psiPrime", ",", "APrime", 
      ",", "BPrime", ",", "dA", ",", "dB", ",", "p", ",", "b", ",", "m", ",", 
      "s", ",", " ", "A1", ",", " ", "A2", ",", " ", "B1", ",", " ", "B2", 
      ",", " ", "NumA1", ",", " ", "NumA2", ",", " ", "NumB1", ",", " ", 
      "NumB2", ",", " ", "NumEigAtEq1", ",", " ", "NumEigAtEq2", ",", " ", 
      "EigAtEq1", ",", " ", "EigAtEq2"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "dA"}], "*", "A"}], "+", 
     RowBox[{"m", "*", "B"}], "+", 
     RowBox[{"2", "*", "p", "*", "A", "*", "B"}]}]}], "\n", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"B", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "dB"}], "-", "m", "-", 
       RowBox[{"2", "*", "p", "*", "A"}], "+", 
       RowBox[{"2", "*", "b"}], "-", 
       RowBox[{"2", "*", "b", "*", 
        RowBox[{"(", 
         RowBox[{"A", "+", "B"}], ")"}]}]}], ")"}]}]}], "\n", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"dA", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "B"}], ")"}]}], "+", 
          RowBox[{"p", "*", "B"}]}], ",", 
         RowBox[{"dA", "*", "A"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dB", "*", "B"}], ",", 
         RowBox[{
          RowBox[{"dB", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "A"}], ")"}]}], "-", 
          RowBox[{"b", "*", 
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}]}]}], ",", "0", ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Vector", " ", "on", " ", "the", " ", "right"}], "-", 
     RowBox[{"hand", " ", "side"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"RHS", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "s"}], "*", "\[Phi]"}], "-", 
        RowBox[{"F", "[", 
         RowBox[{"A", ",", "B"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "s"}], "*", "\[Psi]"}], "-", 
        RowBox[{"G", "[", 
         RowBox[{"A", ",", "B"}], "]"}]}], ",", "\[Phi]", ",", "\[Psi]"}], 
      "}"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"order", " ", "replacer"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"dA", " ", "=", " ", "\[Epsilon]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dB", " ", "=", " ", "\[Epsilon]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"m", " ", "=", " ", 
     RowBox[{"\[Epsilon]", "^", "2"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Inverted", " ", "left"}], "-", 
     RowBox[{"hand", " ", "side", " ", "matrix"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"InvM", "=", " ", 
     RowBox[{"Inverse", "[", "M", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"InvM", ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Isolating", " ", "derivatives", " ", "on", " ", "the", " ", "right", 
      " ", "hand"}], "-", 
     RowBox[{"side", " ", 
      RowBox[{"{", 
       RowBox[{"phiPrime", ",", "psiPrime", ",", "APrime", ",", "BPrime"}], 
       "}"}]}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"DynSis", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"InvM", ".", "RHS"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Writing", " ", "it", " ", "as", " ", "series", " ", "of", " ", 
     "epsilon"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{"DynSis", ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\n", 
   RowBox[{
    RowBox[{"FullSimplify", "[", "DynSis", "]"}], ";"}], "\n"}]}]], "Code",
 CellChangeTimes->{{3.945750828332218*^9, 3.945750853180151*^9}, {
   3.945750897238057*^9, 3.9457509481169853`*^9}, 3.945751168210994*^9, {
   3.9457537604238663`*^9, 3.945753795360165*^9}, {3.945770711402652*^9, 
   3.945770714899729*^9}, {3.945770755334628*^9, 3.945770893491384*^9}, {
   3.94577095157812*^9, 3.9457709612018337`*^9}, {3.945771002434411*^9, 
   3.945771214492611*^9}, {3.945773065216639*^9, 3.9457731104932404`*^9}, {
   3.945773455798366*^9, 3.9457734601775637`*^9}, {3.945773555158053*^9, 
   3.9457736076370897`*^9}, {3.945773638857942*^9, 3.9457737369626226`*^9}, {
   3.945773774369027*^9, 3.9457739039759502`*^9}, {3.945773939692342*^9, 
   3.9457739670059433`*^9}, 3.9457746998773003`*^9, {3.945774730418648*^9, 
   3.9457748019692707`*^9}, {3.94577484148209*^9, 3.945774844005422*^9}},
 CellLabel->
  "In[936]:=",ExpressionUUID->"543cf84c-511d-44fe-a6af-5b20649ca83d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       RowBox[{
        FractionBox["1", 
         RowBox[{"B", " ", "p"}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          SuperscriptBox["B", "2"], " ", 
          SuperscriptBox["p", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"A", " ", "b"}], "+", 
            RowBox[{"b", " ", "B"}], "-", 
            RowBox[{"2", " ", "A", " ", "b", " ", "B"}], "-", 
            RowBox[{"2", " ", "b", " ", 
             SuperscriptBox["B", "2"]}], "+", 
            RowBox[{"A", " ", "b", " ", 
             SuperscriptBox["B", "2"]}], "+", 
            RowBox[{"b", " ", 
             SuperscriptBox["B", "3"]}], "-", 
            RowBox[{"A", " ", 
             SuperscriptBox["B", "2"], " ", "p"}]}], ")"}], " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], 
         RowBox[{"b", " ", 
          SuperscriptBox["B", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"A", "+", "B"}], ")"}], " ", 
          SuperscriptBox["p", "3"]}]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
         SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
         Editable->False]}],
       SeriesData[$CellContext`\[Epsilon], 
        0, {$CellContext`B^(-1)/$CellContext`p, (-1 + $CellContext`B) \
$CellContext`B^(-2) $CellContext`p^(-2), $CellContext`b^(-1) \
$CellContext`B^(-3) ($CellContext`A + $CellContext`B)^(-1) \
$CellContext`p^(-3) ($CellContext`A $CellContext`b + $CellContext`b \
$CellContext`B - 2 $CellContext`A $CellContext`b $CellContext`B - 
          2 $CellContext`b $CellContext`B^2 + $CellContext`A $CellContext`b \
$CellContext`B^2 + $CellContext`b $CellContext`B^3 - $CellContext`A \
$CellContext`B^2 $CellContext`p)}, 0, 3, 1],
       Editable->False], 
      InterpretationBox[
       RowBox[{
        FractionBox[
         RowBox[{"A", " ", "\[Epsilon]"}], 
         RowBox[{"b", " ", "B", " ", 
          RowBox[{"(", 
           RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]], "+", 
        FractionBox[
         RowBox[{"A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "A"}], " ", "b"}], "-", 
            RowBox[{"b", " ", "B"}], "+", 
            RowBox[{"A", " ", "b", " ", "B"}], "+", 
            RowBox[{"b", " ", 
             SuperscriptBox["B", "2"]}], "+", 
            RowBox[{"B", " ", "p"}], "-", 
            RowBox[{"A", " ", "B", " ", "p"}]}], ")"}], " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["B", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], "2"], " ", 
          SuperscriptBox["p", "2"]}]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
         SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 3, 1],
         Editable->False]}],
       SeriesData[$CellContext`\[Epsilon], 
        0, {$CellContext`A $CellContext`b^(-1) $CellContext`B^(-1) \
($CellContext`A + $CellContext`B)^(-1)/$CellContext`p, $CellContext`A \
$CellContext`b^(-2) $CellContext`B^(-2) ($CellContext`A + \
$CellContext`B)^(-2) $CellContext`p^(-2) (-$CellContext`A $CellContext`b - \
$CellContext`b $CellContext`B + $CellContext`A $CellContext`b $CellContext`B + \
$CellContext`b $CellContext`B^2 + $CellContext`B $CellContext`p - \
$CellContext`A $CellContext`B $CellContext`p)}, 1, 3, 1],
       Editable->False], "0", "0"},
     {
      InterpretationBox[
       RowBox[{
        FractionBox["\[Epsilon]", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "A"}], " ", "b"}], "-", 
            RowBox[{"b", " ", "B"}], "+", 
            RowBox[{"A", " ", "b", " ", "B"}], "+", 
            RowBox[{"b", " ", 
             SuperscriptBox["B", "2"]}], "+", 
            RowBox[{"B", " ", "p"}], "-", 
            RowBox[{"A", " ", "B", " ", "p"}]}], ")"}], " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "B", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], "2"], " ", 
          SuperscriptBox["p", "2"]}]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
         SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 3, 1],
         Editable->False]}],
       SeriesData[$CellContext`\[Epsilon], 
        0, {$CellContext`b^(-1) ($CellContext`A + \
$CellContext`B)^(-1)/$CellContext`p, $CellContext`b^(-2) $CellContext`B^(-1) \
($CellContext`A + $CellContext`B)^(-2) $CellContext`p^(-2) (-$CellContext`A \
$CellContext`b - $CellContext`b $CellContext`B + $CellContext`A \
$CellContext`b $CellContext`B + $CellContext`b $CellContext`B^2 + \
$CellContext`B $CellContext`p - $CellContext`A $CellContext`B \
$CellContext`p)}, 1, 3, 1],
       Editable->False], 
      InterpretationBox[
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}]}]]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], "2"]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["A", "2"], " ", "b"}], "+", 
            RowBox[{"A", " ", "b", " ", "B"}], "-", "p", "+", 
            RowBox[{"2", " ", "A", " ", "p"}], "-", 
            RowBox[{
             SuperscriptBox["A", "2"], " ", "p"}]}], ")"}], " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], 
         RowBox[{
          SuperscriptBox["b", "3"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], "3"], " ", "p"}]], "+", 
        InterpretationBox[
         SuperscriptBox[
          RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
         SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
         Editable->False]}],
       SeriesData[$CellContext`\[Epsilon], 
        0, {-$CellContext`b^(-1)/($CellContext`A + $CellContext`B), (-1 + \
$CellContext`A) $CellContext`b^(-2) ($CellContext`A + $CellContext`B)^(-2), \
$CellContext`b^(-3) ($CellContext`A + $CellContext`B)^(-3) \
$CellContext`p^(-1) ($CellContext`A^2 $CellContext`b + $CellContext`A \
$CellContext`b $CellContext`B - $CellContext`p + 
          2 $CellContext`A $CellContext`p - $CellContext`A^2 $CellContext`p)},
         0, 3, 1],
       Editable->False], "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945773687404276*^9, 3.945773737544133*^9}, {
   3.945773777714637*^9, 3.94577378252381*^9}, {3.945773841345211*^9, 
   3.945773904424909*^9}, {3.945773940356845*^9, 3.9457739673594313`*^9}, 
   3.945774701982169*^9, {3.9457747484412727`*^9, 3.9457748033936577`*^9}, 
   3.9457748447752867`*^9},
 CellLabel->
  "Out[945]//MatrixForm=",ExpressionUUID->"a21ef359-9030-42e4-8365-\
24163500865b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       InterpretationBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "A", " ", "B", " ", "p"}], "-", 
           RowBox[{"s", " ", "\[Phi]"}]}], 
          RowBox[{"B", " ", "p"}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", 
              SuperscriptBox["A", "2"], " ", "b", " ", "B", " ", "p"}], "+", 
             RowBox[{"A", " ", "b", " ", 
              SuperscriptBox["B", "2"], " ", "p"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["A", "2"], " ", 
              SuperscriptBox["B", "2"], " ", 
              SuperscriptBox["p", "2"]}], "+", 
             RowBox[{"A", " ", "b", " ", "s", " ", "\[Phi]"}], "+", 
             RowBox[{"b", " ", "B", " ", "s", " ", "\[Phi]"}], "-", 
             RowBox[{"A", " ", "b", " ", "B", " ", "s", " ", "\[Phi]"}], "-", 
             
             RowBox[{"b", " ", 
              SuperscriptBox["B", "2"], " ", "s", " ", "\[Phi]"}], "-", 
             RowBox[{"A", " ", "B", " ", "p", " ", "s", " ", "\[Psi]"}]}], 
            ")"}], " ", "\[Epsilon]"}], 
          RowBox[{"b", " ", 
           SuperscriptBox["B", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}], " ", 
           SuperscriptBox["p", "2"]}]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["A", "2"], "-", 
              RowBox[{"b", " ", 
               SuperscriptBox["B", "2"]}], "+", 
              RowBox[{"A", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "B", "-", 
                 RowBox[{"b", " ", "B"}]}], ")"}]}]}], 
             RowBox[{"b", " ", "B", " ", 
              RowBox[{"(", 
               RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A", "+", "B"}], 
                  RowBox[{"b", " ", "B", " ", 
                   RowBox[{"(", 
                    RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]]}], "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"A", "+", "B"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "B", " ", 
                    "p"}]}], ")"}], "2"], 
                 RowBox[{
                  SuperscriptBox["b", "2"], " ", 
                  SuperscriptBox["B", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"A", "+", "B"}], ")"}], "2"], " ", 
                  SuperscriptBox["p", "2"]}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", 
                 SuperscriptBox["A", "2"], " ", "b", " ", "B", " ", "p"}], 
                "-", 
                RowBox[{"2", " ", "A", " ", "b", " ", 
                 SuperscriptBox["B", "2"], " ", "p"}], "-", 
                RowBox[{"A", " ", "b", " ", "s", " ", "\[Phi]"}], "-", 
                RowBox[{"b", " ", "B", " ", "s", " ", "\[Phi]"}]}], ")"}]}], 
             RowBox[{"b", " ", "B", " ", 
              RowBox[{"(", 
               RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "b"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "B", " ", 
                 "p"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["A", "2"], " ", "b", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "B"}]}], ")"}]}], "+", 
                RowBox[{"s", " ", "\[Phi]"}], "+", 
                RowBox[{"A", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "b"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "B"}]}], ")"}], " ", "B"}], "+", 
                   RowBox[{"2", " ", "B", " ", "p"}], "-", 
                   RowBox[{"s", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Phi]", "+", "\[Psi]"}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], 
             RowBox[{
              SuperscriptBox["b", "2"], " ", 
              SuperscriptBox["B", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}], "2"], " ", 
              SuperscriptBox["p", "2"]}]]}], ")"}], " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], "+", 
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
          SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
          Editable->False]}],
        SeriesData[$CellContext`\[Epsilon], 
         0, {$CellContext`B^(-1) $CellContext`p^(-1) ((-2) $CellContext`A \
$CellContext`B $CellContext`p - $CellContext`s $CellContext`\[Phi]), \
$CellContext`b^(-1) $CellContext`B^(-2) ($CellContext`A + \
$CellContext`B)^(-1) $CellContext`p^(-2) (
           3 $CellContext`A^2 $CellContext`b $CellContext`B $CellContext`p + \
$CellContext`A $CellContext`b $CellContext`B^2 $CellContext`p + 
           2 $CellContext`A^2 $CellContext`B^2 $CellContext`p^2 + \
$CellContext`A $CellContext`b $CellContext`s $CellContext`\[Phi] + \
$CellContext`b $CellContext`B $CellContext`s $CellContext`\[Phi] - \
$CellContext`A $CellContext`b $CellContext`B $CellContext`s $CellContext`\
\[Phi] - $CellContext`b $CellContext`B^2 $CellContext`s $CellContext`\[Phi] - \
$CellContext`A $CellContext`B $CellContext`p $CellContext`s $CellContext`\
\[Psi]), $CellContext`b^(-1) $CellContext`B^(-1) ($CellContext`A + \
$CellContext`B)^(-1) ($CellContext`A^2 - $CellContext`b $CellContext`B^2 + \
$CellContext`A (-1 + $CellContext`B - $CellContext`b \
$CellContext`B))/$CellContext`p + $CellContext`b^(-1) $CellContext`B^(-1) \
($CellContext`A + $CellContext`B)^(-1) $CellContext`p^(-1) \
(-$CellContext`b^(-1) $CellContext`B^(-1) (-1 + $CellContext`A + \
$CellContext`B) ($CellContext`A + $CellContext`B)^(-1)/$CellContext`p + \
$CellContext`b^(-2) $CellContext`B^(-2) ($CellContext`A + \
$CellContext`B)^(-2) $CellContext`p^(-2) (-$CellContext`b (-1 + \
$CellContext`B) ($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) \
$CellContext`B $CellContext`p)^2) ((-2) $CellContext`A^2 $CellContext`b \
$CellContext`B $CellContext`p - 
            2 $CellContext`A $CellContext`b $CellContext`B^2 $CellContext`p - \
$CellContext`A $CellContext`b $CellContext`s $CellContext`\[Phi] - \
$CellContext`b $CellContext`B $CellContext`s $CellContext`\[Phi]) - \
$CellContext`b^(-2) $CellContext`B^(-2) ($CellContext`A + \
$CellContext`B)^(-2) $CellContext`p^(-2) (-$CellContext`b (-1 + \
$CellContext`B) ($CellContext`A + $CellContext`B) + (-1 + $CellContext`A) \
$CellContext`B $CellContext`p) ($CellContext`A^2 $CellContext`b (1 + 
             2 $CellContext`B) + $CellContext`s $CellContext`\[Phi] + \
$CellContext`A (-$CellContext`b (1 - 2 $CellContext`B) $CellContext`B + 
             2 $CellContext`B $CellContext`p - $CellContext`s ($CellContext`\
\[Phi] + $CellContext`\[Psi])))}, 0, 3, 1],
        Editable->False]},
      {
       InterpretationBox[
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"2", " ", "b", " ", "B"}], "-", 
           RowBox[{"2", " ", "A", " ", "b", " ", "B"}], "-", 
           RowBox[{"2", " ", "b", " ", 
            SuperscriptBox["B", "2"]}], "-", 
           RowBox[{"2", " ", "A", " ", "B", " ", "p"}], "+", 
           RowBox[{"s", " ", "\[Psi]"}]}], 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{"A", "+", "B"}], ")"}]}]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "b", " ", "B", " ", "p"}], "-", 
             RowBox[{"5", " ", "A", " ", "b", " ", "B", " ", "p"}], "-", 
             RowBox[{"3", " ", "b", " ", 
              SuperscriptBox["B", "2"], " ", "p"}], "-", 
             RowBox[{"2", " ", "A", " ", "B", " ", 
              SuperscriptBox["p", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["A", "2"], " ", "B", " ", 
              SuperscriptBox["p", "2"]}], "-", 
             RowBox[{"A", " ", "b", " ", "s", " ", "\[Phi]"}], "-", 
             RowBox[{"b", " ", "B", " ", "s", " ", "\[Phi]"}], "+", 
             RowBox[{"p", " ", "s", " ", "\[Psi]"}], "-", 
             RowBox[{"A", " ", "p", " ", "s", " ", "\[Psi]"}]}], ")"}], " ", 
           "\[Epsilon]"}], 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"A", "+", "B"}], ")"}], "2"], " ", "p"}]], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"A", " ", "B"}], "+", 
              RowBox[{"B", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"B", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "p"}], ")"}]}]}], ")"}]}]}], 
             RowBox[{"b", " ", "B", " ", 
              RowBox[{"(", 
               RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "b"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"A", "+", "B"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "B", " ", 
                 "p"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "b", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "B", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A", "+", "B"}], ")"}]}], "-", 
                RowBox[{"2", " ", "A", " ", "B", " ", "p"}], "-", 
                RowBox[{"B", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"B", " ", "p"}], "+", 
                   RowBox[{"s", " ", "\[Phi]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", "s", " ", 
                 "\[Psi]"}]}], ")"}]}], 
             RowBox[{
              SuperscriptBox["b", "2"], " ", 
              SuperscriptBox["B", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"A", "+", "B"}], ")"}], "2"], " ", 
              SuperscriptBox["p", "2"]}]], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A", "+", "B"}], 
                  RowBox[{"b", " ", "B", " ", 
                   RowBox[{"(", 
                    RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]]}], "+", 
                FractionBox[
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "b"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"A", "+", "B"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "A"}], ")"}], " ", "B", " ", 
                    "p"}]}], ")"}], "2"], 
                 RowBox[{
                  SuperscriptBox["b", "2"], " ", 
                  SuperscriptBox["B", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"A", "+", "B"}], ")"}], "2"], " ", 
                  SuperscriptBox["p", "2"]}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "b", " ", 
                 SuperscriptBox["B", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "A", "+", "B"}], ")"}], " ", 
                 "p"}], "-", 
                RowBox[{"2", " ", "A", " ", 
                 SuperscriptBox["B", "2"], " ", 
                 SuperscriptBox["p", "2"]}], "+", 
                RowBox[{"B", " ", "p", " ", "s", " ", "\[Psi]"}]}], ")"}]}], 
             RowBox[{"b", " ", "B", " ", 
              RowBox[{"(", 
               RowBox[{"A", "+", "B"}], ")"}], " ", "p"}]]}], ")"}], " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], "+", 
         InterpretationBox[
          SuperscriptBox[
           RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
          SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
          Editable->False]}],
        SeriesData[$CellContext`\[Epsilon], 
         0, {$CellContext`b^(-1) ($CellContext`A + $CellContext`B)^(-1) (
           2 $CellContext`b $CellContext`B - 
           2 $CellContext`A $CellContext`b $CellContext`B - 
           2 $CellContext`b $CellContext`B^2 - 
           2 $CellContext`A $CellContext`B $CellContext`p + $CellContext`s \
$CellContext`\[Psi]), $CellContext`b^(-2) ($CellContext`A + \
$CellContext`B)^(-2) $CellContext`p^(-1) (
           2 $CellContext`b $CellContext`B $CellContext`p - 
           5 $CellContext`A $CellContext`b $CellContext`B $CellContext`p - 
           3 $CellContext`b $CellContext`B^2 $CellContext`p - 
           2 $CellContext`A $CellContext`B $CellContext`p^2 + 
           2 $CellContext`A^2 $CellContext`B $CellContext`p^2 - \
$CellContext`A $CellContext`b $CellContext`s $CellContext`\[Phi] - \
$CellContext`b $CellContext`B $CellContext`s $CellContext`\[Phi] + \
$CellContext`p $CellContext`s $CellContext`\[Psi] - $CellContext`A \
$CellContext`p $CellContext`s $CellContext`\[Psi]), $CellContext`b^(-1) \
$CellContext`B^(-1) ($CellContext`A + $CellContext`B)^(-1) ($CellContext`A \
$CellContext`B + $CellContext`B (-1 - $CellContext`B (-1 + \
$CellContext`p)))/$CellContext`p - $CellContext`b^(-2) $CellContext`B^(-2) \
($CellContext`A + $CellContext`B)^(-2) $CellContext`p^(-2) (-$CellContext`b \
(-1 + $CellContext`B) ($CellContext`A + $CellContext`B) + (-1 + \
$CellContext`A) $CellContext`B $CellContext`p) (
           2 $CellContext`b (-1 + $CellContext`B) $CellContext`B (-1 + \
$CellContext`A + $CellContext`B) - 
           2 $CellContext`A $CellContext`B $CellContext`p - $CellContext`B \
($CellContext`B $CellContext`p + $CellContext`s $CellContext`\[Phi]) - (-1 + \
$CellContext`B) $CellContext`s $CellContext`\[Psi]) + $CellContext`b^(-1) \
$CellContext`B^(-1) ($CellContext`A + $CellContext`B)^(-1) \
$CellContext`p^(-1) (-$CellContext`b^(-1) $CellContext`B^(-1) (-1 + \
$CellContext`A + $CellContext`B) ($CellContext`A + \
$CellContext`B)^(-1)/$CellContext`p + $CellContext`b^(-2) $CellContext`B^(-2) \
($CellContext`A + $CellContext`B)^(-2) $CellContext`p^(-2) (-$CellContext`b \
(-1 + $CellContext`B) ($CellContext`A + $CellContext`B) + (-1 + \
$CellContext`A) $CellContext`B $CellContext`p)^2) ((-2) $CellContext`b \
$CellContext`B^2 (-1 + $CellContext`A + $CellContext`B) $CellContext`p - 
            2 $CellContext`A $CellContext`B^2 $CellContext`p^2 + \
$CellContext`B $CellContext`p $CellContext`s $CellContext`\[Psi])}, 0, 3, 1],
        Editable->False]},
      {"\[Phi]"},
      {"\[Psi]"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945773687404276*^9, 3.945773737544133*^9}, {
   3.945773777714637*^9, 3.94577378252381*^9}, {3.945773841345211*^9, 
   3.945773904424909*^9}, {3.945773940356845*^9, 3.9457739673594313`*^9}, 
   3.945774701982169*^9, {3.9457747484412727`*^9, 3.9457748033936577`*^9}, 
   3.9457748447881193`*^9},
 CellLabel->
  "Out[947]//MatrixForm=",ExpressionUUID->"b2644fff-8827-4166-8e06-\
38406fc328be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"DynSis", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "->", " ", "\[Epsilon]"}], ",", " ", 
      RowBox[{"b", "->", "\[Epsilon]"}]}], "}"}]}], "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.945753216603607*^9, 3.945753221358643*^9}, {
   3.945753257726884*^9, 3.9457532631574793`*^9}, {3.945753503932041*^9, 
   3.9457535814110413`*^9}, {3.9457536182588253`*^9, 
   3.9457536322847557`*^9}, {3.945753689410222*^9, 3.9457536909653378`*^9}, {
   3.945753733994916*^9, 3.945753737772562*^9}, {3.945753809525464*^9, 
   3.945753813276737*^9}, 3.945754303978817*^9, {3.9457739877791348`*^9, 
   3.945774000073498*^9}},
 CellLabel->
  "In[871]:=",ExpressionUUID->"77d76c94-0302-4faa-80d2-4ea60201c85d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["A", "2"], " ", "\[Epsilon]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "B"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", " ", 
              SuperscriptBox["\[Epsilon]", "2"]}], "+", 
             RowBox[{"s", " ", "\[Phi]"}]}], ")"}]}], "+", 
          RowBox[{"A", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", 
             RowBox[{"B", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Epsilon]"}], ")"}], " ", 
              "\[Epsilon]"}], "+", 
             RowBox[{"s", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "\[Phi]"}], "+", "\[Psi]"}], ")"}]}]}], 
            ")"}]}]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "B", "+", 
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "B"}], ")"}]}]}], ")"}], " ", 
          "\[Epsilon]"}]]}]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "B"}], " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"A", " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"2", " ", "B"}]}], ")"}]}], "+", "\[Epsilon]", "+", 
            RowBox[{"B", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "\[Epsilon]"}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{"B", " ", "s", " ", "\[Phi]"}], "+", 
         RowBox[{"s", " ", "\[Psi]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "B", "+", 
           RowBox[{"A", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "B"}], ")"}]}]}], ")"}], " ", 
         "\[Epsilon]"}]]},
      {"\[Phi]"},
      {"\[Psi]"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.945753813754382*^9, 3.9457541443831577`*^9, 3.945754305237883*^9, 
   3.945758090871977*^9, 3.9457731148527193`*^9, {3.94577399482552*^9, 
   3.9457740004002447`*^9}},
 CellLabel->
  "Out[871]//MatrixForm=",ExpressionUUID->"952615d1-5c79-4fef-af45-\
3b2c959fd31b"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"357c353f-00b8-4c9b-b950-fb9bfd3c4170"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9457508251604958`*^9},ExpressionUUID->"5acbc3da-3a78-48e5-8011-\
670b1a02efa8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.945750778910378*^9, 
  3.945750779783099*^9}},ExpressionUUID->"a5da3ba7-2714-4f5e-ba11-\
00c67949d52a"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 8}, {Automatic, 8}},
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1a41f983-6cde-40c9-b982-7ed12c0e284f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 213, 4, 96, "Title",ExpressionUUID->"8db55d0f-f02a-4d9d-865a-c120f3704bec"],
Cell[792, 28, 184, 4, 52, "Subtitle",ExpressionUUID->"c8153deb-aeb0-4c36-a643-e6822f47929e"],
Cell[CellGroupData[{
Cell[1001, 36, 5374, 142, 409, "Code",ExpressionUUID->"543cf84c-511d-44fe-a6af-5b20649ca83d"],
Cell[6378, 180, 8078, 200, 125, "Output",ExpressionUUID->"a21ef359-9030-42e4-8365-24163500865b"],
Cell[14459, 382, 17994, 401, 174, "Output",ExpressionUUID->"b2644fff-8827-4166-8e06-38406fc328be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32490, 788, 805, 16, 51, "Code",ExpressionUUID->"77d76c94-0302-4faa-80d2-4ea60201c85d"],
Cell[33298, 806, 2902, 86, 118, "Output",ExpressionUUID->"952615d1-5c79-4fef-af45-3b2c959fd31b"]
}, Open  ]],
Cell[36215, 895, 81, 0, 29, "Input",ExpressionUUID->"357c353f-00b8-4c9b-b950-fb9bfd3c4170"],
Cell[36299, 897, 130, 3, 29, "Input",ExpressionUUID->"5acbc3da-3a78-48e5-8011-670b1a02efa8"],
Cell[36432, 902, 152, 3, 29, "Input",ExpressionUUID->"a5da3ba7-2714-4f5e-ba11-00c67949d52a"]
}, Open  ]]
}
]
*)

